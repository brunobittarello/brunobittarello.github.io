!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=9)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(8),r=i(5),n=i(4);class o{constructor(t){o.application=t,this.deckCtrl=new s.DeckController(o.application.stage),this.textImageTool=new r.RandomTextImagesTool(o.application.stage),this.fireParticleSys=new n.FireParticleSystem(o.application.stage),this.currentTest=1,this.currTime=Date.now()}update(t){this.elapsed=Date.now()-this.currTime,this.currTime=Date.now();var e=.001*this.elapsed;1===this.currentTest?this.deckCtrl.update(t,e):2===this.currentTest?this.textImageTool.update(t,e):3===this.currentTest&&this.fireParticleSys.update(t,e)}onKeyDown(t){if(t instanceof KeyboardEvent!=!1){var e=t;e.repeat||(console.log(e.key),"1"===e.key&&this.changeCurrentTest(1),"2"===e.key&&this.changeCurrentTest(2),"3"===e.key&&this.changeCurrentTest(3))}}changeCurrentTest(t){this.currentTest!==t&&(1===this.currentTest?this.deckCtrl.desactive():2===this.currentTest?this.textImageTool.desactive():3===this.currentTest&&this.fireParticleSys.desactive(),console.log("changeCurrentTest "+t),this.currentTest=t,1===this.currentTest?this.deckCtrl.active():2===this.currentTest?this.textImageTool.active():3===this.currentTest&&this.fireParticleSys.active())}}e.Core=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.TestBase=class{}},function(t,e){t.exports=PIXI},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Fire=class extends PIXI.Sprite{constructor(t){super(t),this.anchor.set(.5),this.scale.set(3),this.frame=new PIXI.Rectangle(0,0,64,64),this.frameTime=0,this.deactive()}resetEmition(t,e,i){this.isActive=!0,this.frameIndex=0,this.frameSpeed=.05*Math.random()+.01,this.frameTime=0,this.position.set(0),this.direction=t,this.rotation=t,this.timeToLive=i,this.speed=e,this.getNextFrame()}update(t){!1!==this.isActive&&(this.frameTime+=t,this.frameTime>this.frameSpeed&&(this.getNextFrame(),this.frameTime=0),this.position.x+=Math.sin(this.direction)*(this.speed*this.scale.x),this.position.y+=Math.cos(this.direction)*(this.speed*this.scale.y),this.timeToLive-=t,this.timeToLive<0&&this.deactive())}getNextFrame(){this.frameIndex+=1,this.frameIndex>=64?this.timeToLive=-1:(this.frame.x=64*Math.floor(this.frameIndex%8),this.frame.y=64*Math.floor(this.frameIndex/8),this.texture.frame=this.frame)}deactive(){this.isActive=!1,this.position.set(9999)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1),r=i(0),n=i(3),o=2,a=10,h=.01,c=.01;e.FireParticleSystem=class extends s.TestBase{constructor(t){super(),this.fires=new Array,this.isReady=!1,this.time=0,this.texture=PIXI.Texture.fromImage("./assets/flames.png"),this.particleCont=new PIXI.particles.ParticleContainer(1e4,{scale:!0,position:!0,rotation:!0,uvs:!0,alpha:!0}),t.addChild(this.particleCont)}active(){}desactive(){this.particleCont.position.set(99999,100)}start(){if(0!==this.texture.width){for(var t=0;t<a;t++){var e=new n.Fire(this.texture.clone());this.fires.push(e),this.particleCont.addChild(e)}this.resetNextEmitionTime(),this.isReady=!0}else console.log("cant start now!")}update(t,e){!1!==this.isReady?(this.particleCont.position.set(.5*r.Core.application.screen.width,.9*r.Core.application.screen.height),e>1&&(e=1),this.time+=e,this.fires.forEach(t=>{t.update(e)}),this.time>this.nextEmitionTime&&this.emitFire(this.findEndedFire())):this.start()}findEndedFire(){var t=null;return this.fires.forEach(e=>{!1!==e.isActive||(t=e)}),t}emitFire(t){null!==t&&(t.resetEmition(this.getDirection(),this.getFireSpeed(),o),this.resetNextEmitionTime())}getDirection(){return Math.random()*Math.PI*.5+.75*Math.PI}getFireSpeed(){return.4*Math.random()+.6}resetNextEmitionTime(){this.time=0,this.nextEmitionTime=Math.random()*c+h}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1),r=i(0);e.RandomTextImagesTool=class extends s.TestBase{constructor(t){super(),this.time=0,this.texture=PIXI.Texture.fromImage("./assets/tiles.png"),this.toolContainer=new PIXI.Container,t.addChild(this.toolContainer)}active(){}desactive(){this.toolContainer.position.set(99999,100)}update(t,e){this.toolContainer.position.x=.5*r.Core.application.screen.width,this.toolContainer.position.y=.5*r.Core.application.screen.height,e>1&&(e=1),this.time+=e,this.time>2&&(this.time-=2,this.clear(),this.randomize())}clear(){for(var t=this.toolContainer.children.length-1;t>=0;t--)this.toolContainer.children[t].destroy(),this.toolContainer.removeChild(this.toolContainer.children[t])}randomize(){for(var t=0;t<100;t++){var e=this.getRandomInt(4);1===e&&this.toolContainer.addChild(this.createRandomImage()),2===e&&this.toolContainer.addChild(this.createRandomText())}}createRandomText(){var t=this.getRandomString()+this.getRandomString()+this.getRandomString();let e=new PIXI.Text(t,{fontFamily:"Arial",fontSize:this.getFontSize(),align:"center"});return e.position.x=this.getPosition(),e.position.y=this.getPosition(),e}createRandomImage(){var t=this.texture.clone();t.frame=this.getFrame();var e=new PIXI.Sprite(t);return e.anchor.set(.5),e.position.x=this.getPosition(),e.position.y=this.getPosition(),e}getRandomString(){return Math.random().toString(36).substr(2,this.getStrLen())}getFontSize(){return this.getRandomInt(14)+10}getStrLen(){return this.getRandomInt(8)}getPosition(){return this.getRandomInt(600)-300}getFrame(){var t=this.getRandomInt(13),e=this.getRandomInt(4);return new PIXI.Rectangle(32*t,32*e,32,32)}getRandomInt(t){return Math.floor(Math.random()*t)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Card=class extends PIXI.Container{constructor(t){super();var e=new PIXI.Sprite(t);e.anchor.set(.5),e.scale.set(.5),this.addChild(e)}startMoving(t,e,i){this.startX=t.x,this.startY=t.y,this.targetX=e,this.targetY=i,this.isMoving=!0,this.moveTimer=0}update(t){this.isMoving&&this.move(t)}move(t){this.moveTimer+=t;var e=.5*this.moveTimer;if(e>=1)return this.position.x=this.targetX,this.position.y=this.targetY,void(this.isMoving=!1);this.position.x=this.lerp(this.startX,this.targetX,e),this.position.y=this.lerp(this.startY,this.targetY,e)}lerp(t,e,i){return(1-i)*t+i*e}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(6),r=i(2),n=144,o=4;e.Deck=class extends PIXI.Container{constructor(){super(),this.cards=new Array}populate(t){for(var e=0;e<n;e++){var i=new s.Card(t);i.position.x=o*e,i.position.y=0,this.cards[e]=i,this.addChild(this.cards[e])}}removeCard(){return 0===this.cards.length?null:this.cards.pop()}addCard(t){var e=this.toLocal(t.toGlobal(new r.Point(0,0)));t.startMoving(e,o*this.cards.length,0),this.cards.push(t),this.addChild(t),t.position.set(e.x,e.y)}isReadyToSwap(){return this.cards.forEach(t=>{if(!0===t.isMoving)return!1}),!0}update(t){this.cards.forEach(e=>{e.update(t)})}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1),r=i(7),n=i(0);e.DeckController=class extends s.TestBase{constructor(t){super(),this.time=0,this.texture=PIXI.Texture.fromImage("./assets/card.png"),this.deckSource=new r.Deck,this.deckTarget=new r.Deck,this.deckSource.populate(this.texture),this.deckSource.position.set(100,100),this.deckTarget.position.set(100,600),console.log("Card created: "+this.deckSource.children.length),t.addChild(this.deckSource),t.addChild(this.deckTarget),this.fpsLabel=new PIXI.Text("fps: "),t.addChild(this.fpsLabel)}active(){this.deckSource.position.set(100,100),this.deckTarget.position.set(100,600)}desactive(){this.deckSource.position.set(99999,100),this.deckTarget.position.set(99999,600)}update(t,e){this.fpsLabel.text="fps: "+n.Core.application.ticker.FPS.toString().substr(0,4),e>.5&&(e=.5),this.time+=e,this.time>1&&(this.time-=1,this.transferCard()),this.deckSource.update(e),this.deckTarget.update(e)}transferCard(){var t=this.deckSource.removeCard();null===t?!0===this.deckTarget.isReadyToSwap()&&this.swapDecks():this.deckTarget.addCard(t)}swapDecks(){var t=this.deckTarget;this.deckTarget=this.deckSource,this.deckSource=t}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),r=i(2);var n=c(),o=new r.Application(1280*n,720*n,{backgroundColor:1087931});o.stage.scale.set(n),document.getElementById("display").appendChild(o.view);const a=new s.Core(o);function h(){!function(t){console.log("resize to w = "+1280*t+" h = "+720*t+" s = "+t),o.renderer.resize(.9*window.innerWidth,.9*window.innerHeight),o.stage.scale.set(Math.max(.4,t))}(c())}function c(){console.log("document.documentElement "+document.documentElement.clientWidth+"/"+document.documentElement.clientHeight),console.log("window "+window.innerWidth+"/"+window.innerHeight),console.log("window.screen "+window.screen.width+"/"+window.screen.height);var t=Math.min(document.documentElement.clientWidth,window.innerWidth,window.screen.width),e=Math.min(document.documentElement.clientHeight,window.innerHeight,window.screen.height);console.log("SCREEN "+t+"/"+e);var i=Math.min(t-50,1230)/1280,s=Math.min(e-50,670)/720;return i<s?(console.log("WWW"),.9*i):(console.log("HHH"),.9*s)}o.ticker.add(function(t){a.update(t)}),h(),window.addEventListener("resize",function(){h()}),window.addEventListener("keydown",function(t){a.onKeyDown(t)})}]);
//# sourceMappingURL=main.bundle.js.map